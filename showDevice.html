<!DOCTYPE html>
<html lang="en">

<head>
    <title>ERP Project</title>
    <link rel="stylesheet" href="showDevice.css">
    <link rel="icon" type="image/x-icon" href="/icon.png">
    <script>
        function onLoad() {
            loadDevice();
            console.log("Called loadData()");
        }
        window.onload = onLoad;
    </script>
    <link rel='stylesheet' type='text/css' href='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.23.0/maps/maps.css'>
    <script src='https://api.tomtom.com/maps-sdk-for-web/cdn/6.x/6.23.0/maps/maps-web.min.js'></script>
    <script src="loadDevice.js"></script>
    <script src="addDevice.js"></script>
</head>

<body>
    <div id="header">
        <div id="title">
            <a href="https://databasemls.online">ERP Raspberry Shake Dashboard</a>
        </div>
    </div>

    <div id="mainContent">
        <div id="deviceList">
            <div id="deviceListHeader">
                Connected Devices:
            </div>

            <div id="deviceListMain">

            </div>
        </div>
        <div id="deviceInformation">
            <div id="infoHeader">
                <div id="returnHomeButton" onclick="returnHome()">
                    <img src="/backicon.png" alt="Return to Dashboard" width="32" height="32">
                </div>
                <div id="deviceNameText">
                </div>
            </div>
            <div id="device-info">
                <h2>Device Information</h2>
                <div id="deviceInfoMap"></div>
                <div id="removeDeviceDiv">
                    <button id="removeDeviceButton" onclick="removeDevice('${deviceId}')">Remove Device</button>
                </div>     
            </div>
            <div class="activity-counter" id="activity-counter">
                <div id="activityLogHeader">
                    <h2>Activity log</h2>
                </div>
                <div id="activity-log">
                </div>
            </div>
        </div>
    </div>
    <div id="addDevicePopup">
        <div id="addDeviceHeader">
            <div id="addDeviceClose" onClick="closeAddDevicePopup()">
                <img src="/backicon.png" alt="Return to Dashboard" width="32" height="32">
            </div>
            <div id="popupTitle">
                Add New Device
            </div>
        </div>
        <div id="addDeviceForm">
            <form id="form">
                <div id="formEntry">
                    <label for="deviceName">Device Name:</label>
                    <input type="text" id="deviceName" required>
                    <div id="nameError"></div>
                </div>

                <div id="formEntry">
                    <label for="ipAddress">IP Address:</label>
                    <input type="text" id="ipAddress" required>
                    <div id="ipError"></div>
                </div>

                <div id="formEntry">
                    <label for="userName">Username:</label>
                    <input type="text" id="userName" required>
                    <div id="usernameError"></div>
                </div>

                <div id="formEntry">
                    <label for="password">Password:</label>
                    <input type="text" id="password" required>
                    <div id="passwordError"></div>
                </div>

                <div id="formEntry">
                    <label for="latitude">Latitude:</label>
                    <input type="number" id="latitude" required>
                    <div id="latitudeError"></div>
                </div>

                <div id="formEntry">
                    <label for="longitude">Longitude:</label>
                    <input type="number" id="longitude" required>
                    <div id="longitudeError"></div>
                </div>

                <div id="formEntry">
                    <label for="altitude">Altitude:</label>
                    <input type="number" id="altitude" required>
                    <div id="altitudeError"></div>
                </div>
            </form>
            <div id="submitFormButton">
                <button onclick="submitForm()">Submit</button>
            </div>
        </div>
    </div>

</body>
<script>
    
  const activityLog = document.querySelectorAll('.activity-log p');
  const activityCounter = {};
  
  activityLog.forEach(log => {
    const animal = log.querySelector('strong').innerText;
    if (activityCounter[animal]) {
      activityCounter[animal]++;
    } else {
      activityCounter[animal] = 1;
    }
  });
  
  const activityCounterElement = document.getElementById('activity-counter');
  
  for (const animal in activityCounter) {
    const count = activityCounter[animal];
    const animalCountElement = document.createElement('p');
    animalCountElement.innerHTML = `<strong>${animal}:</strong> ${count}`;
    activityCounterElement.appendChild(animalCountElement);
  }
</script>
</html>
